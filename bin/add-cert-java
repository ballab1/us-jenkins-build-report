#! /usr/bin/env bash
#
# May need to execute this script with sudo
# default keystore password is 'changeit'
# $1 is an alias
# $2 is a cert file to be added to the default keystore
#
# - Use your browser's facilities to view the certificate
#    In firefox, click on the little (i) icon to the left of the URL
#    At the bottom of that resulting drop down click on 'more information'
#    In the resulting window click on 'view certificate'
#    In the subsequent window, select 'details' on the top
#    In the subsequent window, select 'export' on the bottom left
#    Now save the certificate to a file
# - Save the certificate somewhere
# - run 'bin/add-cert-java artifactory location/of/your/saved/certificate'

usage() {
   echo
   printf "Adds a 'certificate' with name 'alias' to the JDK/JRE cacerts file.\n\n"
   printf "Usage: $0 alias-name certificate-file\n\n"
}

if [ $# -ne 2 ]; then
   usage
   exit -1
fi

if [ $(uname) = 'Darwin' ]; then
   JAVA_HOME="$(/usr/libexec/java_home)"
fi

echo "JAVA_HOME is $JAVA_HOME"
keytool -import -alias $1 -keystore  "$JAVA_HOME/lib/security/cacerts" -file $2
