#!/bin/bash

# Ensure we are executing in the project directory.
cd "$(dirname $0)/.."

ORG_ID='org/ballab1'
ARTIFACT_ID="$(< .app-name)"
REVISION=$(< .revision)
QUALIFIER=$2

source_dir='deploy'
sub_target="$ORG_ID/$ARTIFACT_ID/$REVISION/"

if [ "${QUALIFIER:-} ]; then
   jar="$source_dir/$ARTIFACT_ID-$REVISION-$QUALIFIER.jar"
else
   jar="$source_dir/$ARTIFACT_ID-$REVISION.jar"
fi
pom="$source_dir/$ARTIFACT_ID-$REVISION.pom"

if [ "$1" == 'art' ]; then
   :
elif [ "$1" == 'local' ]; then
   target_dir="$HOME/.m2/repository/$sub_target"
   mkdir -p "$target_dir"
   cp "$jar" "$pom" "$target_dir"
   echo "Content of $target_dir:"
   ls -latr "$target_dir"
else
   echo "Usage: $0 art|local [qualifier]"
   echo
fi
